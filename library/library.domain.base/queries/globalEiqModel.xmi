<?xml version="1.0" encoding="ASCII"?>
<xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:eMFPatternLanguage="http://www.eclipse.org/incquery/patternlanguage/emf/EMFPatternLanguage" xmlns:ecore="http://www.eclipse.org/emf/2002/Ecore" xmlns:patternLanguage="http://www.eclipse.org/incquery/patternlanguage/PatternLanguage" xmlns:types="http://www.eclipse.org/xtext/common/JavaVMTypes" xmlns:xbase="http://www.eclipse.org/xtext/xbase/Xbase">
  <eMFPatternLanguage:PatternModel>
    <patterns name="library.base.libraryName" fileName="platform:/resource/library.domain.base/src/library/base/BaseQueries.eiq">
      <parameters name="L">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EClass" href="library.base#//Library"/>
        </type>
      </parameters>
      <parameters name="N"/>
      <bodies>
        <constraints xsi:type="patternLanguage:PathExpressionConstraint">
          <head>
            <type xsi:type="eMFPatternLanguage:ClassType">
              <classname xsi:type="ecore:EClass" href="library.base#//Library"/>
            </type>
            <tail>
              <type xsi:type="eMFPatternLanguage:ReferenceType">
                <refname xsi:type="ecore:EReference" href="library.base#//Library/books"/>
              </type>
              <tail>
                <type xsi:type="eMFPatternLanguage:ReferenceType">
                  <refname xsi:type="ecore:EAttribute" href="library.base#//Book/bookCategory"/>
                </type>
              </tail>
            </tail>
            <src var="L"/>
            <dst xsi:type="patternLanguage:VariableValue">
              <value var="C"/>
            </dst>
          </head>
        </constraints>
        <constraints xsi:type="patternLanguage:PathExpressionConstraint">
          <head>
            <type xsi:type="eMFPatternLanguage:ClassType">
              <classname xsi:type="ecore:EClass" href="library.base#//Library"/>
            </type>
            <tail>
              <type xsi:type="eMFPatternLanguage:ReferenceType">
                <refname xsi:type="ecore:EAttribute" href="library.base#//Library/baseName"/>
              </type>
            </tail>
            <src var="L"/>
            <dst xsi:type="patternLanguage:VariableValue">
              <value var="BN"/>
            </dst>
          </head>
        </constraints>
        <constraints xsi:type="patternLanguage:CompareConstraint">
          <leftOperand xsi:type="patternLanguage:IntValue" value="1"/>
          <rightOperand xsi:type="patternLanguage:AggregatedValue">
            <aggregator xsi:type="patternLanguage:CountAggregator"/>
            <call patternRef="/0/@patterns.1">
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="L"/>
              </parameters>
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="C"/>
              </parameters>
            </call>
          </rightOperand>
        </constraints>
        <constraints xsi:type="patternLanguage:CompareConstraint">
          <leftOperand xsi:type="patternLanguage:VariableValue">
            <value var="N"/>
          </leftOperand>
          <rightOperand xsi:type="patternLanguage:FunctionEvaluationValue">
            <expression xsi:type="xbase:XBinaryOperation">
              <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.StringExtensions#org.eclipse.xtext.xbase.lib.StringExtensions.operator_plus(java.lang.String,java.lang.String)"/>
              <leftOperand xsi:type="xbase:XBinaryOperation">
                <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.StringExtensions#org.eclipse.xtext.xbase.lib.StringExtensions.operator_plus(java.lang.String,java.lang.Object)"/>
                <leftOperand xsi:type="xbase:XBinaryOperation">
                  <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.StringExtensions#org.eclipse.xtext.xbase.lib.StringExtensions.operator_plus(java.lang.String,java.lang.String)"/>
                  <leftOperand xsi:type="xbase:XFeatureCall" feature="/1"/>
                  <rightOperand xsi:type="xbase:XStringLiteral" value=" ("/>
                </leftOperand>
                <rightOperand xsi:type="xbase:XFeatureCall" feature="/2"/>
              </leftOperand>
              <rightOperand xsi:type="xbase:XStringLiteral" value=")"/>
            </expression>
          </rightOperand>
        </constraints>
      </bodies>
      <bodies>
        <constraints xsi:type="patternLanguage:PathExpressionConstraint">
          <head>
            <type xsi:type="eMFPatternLanguage:ClassType">
              <classname xsi:type="ecore:EClass" href="library.base#//Library"/>
            </type>
            <tail>
              <type xsi:type="eMFPatternLanguage:ReferenceType">
                <refname xsi:type="ecore:EAttribute" href="library.base#//Library/baseName"/>
              </type>
            </tail>
            <src var="L"/>
            <dst xsi:type="patternLanguage:VariableValue">
              <value var="BN"/>
            </dst>
          </head>
        </constraints>
        <constraints xsi:type="patternLanguage:CompareConstraint">
          <leftOperand xsi:type="patternLanguage:VariableValue">
            <value var="V"/>
          </leftOperand>
          <rightOperand xsi:type="patternLanguage:AggregatedValue">
            <aggregator xsi:type="patternLanguage:CountAggregator"/>
            <call patternRef="/0/@patterns.1">
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="L"/>
              </parameters>
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="_C"/>
              </parameters>
            </call>
          </rightOperand>
        </constraints>
        <constraints xsi:type="patternLanguage:CheckConstraint">
          <expression xsi:type="xbase:XBinaryOperation">
            <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.BooleanExtensions#org.eclipse.xtext.xbase.lib.BooleanExtensions.operator_or(boolean,boolean)"/>
            <leftOperand xsi:type="xbase:XBinaryOperation">
              <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.IntegerExtensions#org.eclipse.xtext.xbase.lib.IntegerExtensions.operator_equals(int,int)"/>
              <leftOperand xsi:type="xbase:XFeatureCall" feature="/3"/>
              <rightOperand xsi:type="xbase:XNumberLiteral" value="0"/>
            </leftOperand>
            <rightOperand xsi:type="xbase:XBinaryOperation">
              <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.IntegerExtensions#org.eclipse.xtext.xbase.lib.IntegerExtensions.operator_greaterThan(int,int)"/>
              <leftOperand xsi:type="xbase:XFeatureCall" feature="/4"/>
              <rightOperand xsi:type="xbase:XNumberLiteral" value="1"/>
            </rightOperand>
          </expression>
        </constraints>
        <constraints xsi:type="patternLanguage:CompareConstraint">
          <leftOperand xsi:type="patternLanguage:VariableValue">
            <value var="N"/>
          </leftOperand>
          <rightOperand xsi:type="patternLanguage:FunctionEvaluationValue">
            <expression xsi:type="xbase:XBinaryOperation">
              <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.StringExtensions#org.eclipse.xtext.xbase.lib.StringExtensions.operator_plus(java.lang.String,java.lang.String)"/>
              <leftOperand xsi:type="xbase:XFeatureCall" feature="/5"/>
              <rightOperand xsi:type="xbase:XStringLiteral" value=" (None)"/>
            </expression>
          </rightOperand>
        </constraints>
      </bodies>
    </patterns>
    <patterns name="library.base.mostPopularBookCategory" fileName="platform:/resource/library.domain.base/src/library/base/BaseQueries.eiq">
      <parameters name="L">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EClass" href="library.base#//Library"/>
        </type>
      </parameters>
      <parameters name="C">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EEnum" href="library.base#//BookCategory"/>
        </type>
      </parameters>
      <bodies>
        <constraints xsi:type="patternLanguage:PathExpressionConstraint">
          <head>
            <type xsi:type="eMFPatternLanguage:ClassType">
              <classname xsi:type="ecore:EClass" href="library.base#//Library"/>
            </type>
            <tail>
              <type xsi:type="eMFPatternLanguage:ReferenceType">
                <refname xsi:type="ecore:EReference" href="library.base#//Library/books"/>
              </type>
              <tail>
                <type xsi:type="eMFPatternLanguage:ReferenceType">
                  <refname xsi:type="ecore:EAttribute" href="library.base#//Book/bookCategory"/>
                </type>
              </tail>
            </tail>
            <src var="L"/>
            <dst xsi:type="patternLanguage:VariableValue">
              <value var="C"/>
            </dst>
          </head>
        </constraints>
        <constraints xsi:type="patternLanguage:PatternCompositionConstraint" negative="true">
          <call patternRef="/0/@patterns.2">
            <parameters xsi:type="patternLanguage:VariableValue">
              <value var="_BC"/>
            </parameters>
            <parameters xsi:type="patternLanguage:VariableValue">
              <value var="C"/>
            </parameters>
          </call>
        </constraints>
      </bodies>
    </patterns>
    <patterns name="library.base.moreBooksInCategoryThan" fileName="platform:/resource/library.domain.base/src/library/base/BaseQueries.eiq">
      <parameters name="C1">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EEnum" href="library.base#//BookCategory"/>
        </type>
      </parameters>
      <parameters name="C2">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EEnum" href="library.base#//BookCategory"/>
        </type>
      </parameters>
      <bodies>
        <constraints xsi:type="patternLanguage:CompareConstraint">
          <leftOperand xsi:type="patternLanguage:VariableValue">
            <value var="N"/>
          </leftOperand>
          <rightOperand xsi:type="patternLanguage:AggregatedValue">
            <aggregator xsi:type="patternLanguage:CountAggregator"/>
            <call patternRef="/0/@patterns.3">
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="C1"/>
              </parameters>
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="_B1"/>
              </parameters>
            </call>
          </rightOperand>
        </constraints>
        <constraints xsi:type="patternLanguage:CompareConstraint">
          <leftOperand xsi:type="patternLanguage:VariableValue">
            <value var="M"/>
          </leftOperand>
          <rightOperand xsi:type="patternLanguage:AggregatedValue">
            <aggregator xsi:type="patternLanguage:CountAggregator"/>
            <call patternRef="/0/@patterns.3">
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="C2"/>
              </parameters>
              <parameters xsi:type="patternLanguage:VariableValue">
                <value var="_B2"/>
              </parameters>
            </call>
          </rightOperand>
        </constraints>
        <constraints xsi:type="patternLanguage:CheckConstraint">
          <expression xsi:type="xbase:XBinaryOperation">
            <feature xsi:type="types:JvmOperation" href="java:/Objects/org.eclipse.xtext.xbase.lib.ComparableExtensions#org.eclipse.xtext.xbase.lib.ComparableExtensions.operator_greaterEqualsThan(java.lang.Comparable,C)"/>
            <leftOperand xsi:type="xbase:XFeatureCall" feature="/6"/>
            <rightOperand xsi:type="xbase:XFeatureCall" feature="/7"/>
          </expression>
        </constraints>
        <constraints xsi:type="patternLanguage:CompareConstraint" feature="!=">
          <leftOperand xsi:type="patternLanguage:VariableValue">
            <value var="C1"/>
          </leftOperand>
          <rightOperand xsi:type="patternLanguage:VariableValue">
            <value var="C2"/>
          </rightOperand>
        </constraints>
      </bodies>
    </patterns>
    <patterns name="library.base.categoryOfBook" fileName="platform:/resource/library.domain.base/src/library/base/BaseQueries.eiq">
      <parameters name="c">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EEnum" href="library.base#//BookCategory"/>
        </type>
      </parameters>
      <parameters name="b">
        <type xsi:type="eMFPatternLanguage:ClassType">
          <classname xsi:type="ecore:EClass" href="library.base#//Book"/>
        </type>
      </parameters>
      <bodies>
        <constraints xsi:type="patternLanguage:PathExpressionConstraint">
          <head>
            <type xsi:type="eMFPatternLanguage:ClassType">
              <classname xsi:type="ecore:EClass" href="library.base#//Book"/>
            </type>
            <tail>
              <type xsi:type="eMFPatternLanguage:ReferenceType">
                <refname xsi:type="ecore:EAttribute" href="library.base#//Book/bookCategory"/>
              </type>
            </tail>
            <src var="b"/>
            <dst xsi:type="patternLanguage:VariableValue">
              <value var="c"/>
            </dst>
          </head>
        </constraints>
      </bodies>
    </patterns>
    <importPackages>
      <packageImport>
        <ePackage href="library.base#/"/>
      </packageImport>
    </importPackages>
  </eMFPatternLanguage:PatternModel>
  <types:JvmFormalParameter name="BN">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
  <types:JvmFormalParameter name="C">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
  <types:JvmFormalParameter name="V">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
  <types:JvmFormalParameter name="V">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
  <types:JvmFormalParameter name="BN">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
  <types:JvmFormalParameter name="N">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
  <types:JvmFormalParameter name="M">
    <parameterType xsi:type="types:JvmParameterizedTypeReference"/>
  </types:JvmFormalParameter>
</xmi:XMI>
